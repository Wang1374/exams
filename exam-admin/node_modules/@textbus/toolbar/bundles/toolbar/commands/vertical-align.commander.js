import { FormatEffect, FormatData } from '@textbus/core';
export class VerticalAlignCommander {
    constructor(formatter) {
        this.formatter = formatter;
        this.recordHistory = true;
    }
    command(context, params) {
        this.recordHistory = false;
        if (context.selection.collapsed) {
            return;
        }
        this.recordHistory = true;
        context.selection.ranges.forEach(range => {
            range.getSelectedScope().forEach(scope => {
                scope.fragment.apply(this.formatter, {
                    effect: FormatEffect.Valid,
                    startIndex: scope.startIndex,
                    endIndex: scope.endIndex,
                    formatData: new FormatData({
                        styles: {
                            verticalAlign: params
                        }
                    })
                });
            });
        });
    }
}
//# sourceMappingURL=vertical-align.commander.js.map